var h=class{events={};#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]};#e=!1;logErrors=!0;get isDestroyed(){return this.#e}on(e,t){if(this.#e)throw new Error("EventEmitter is destroyed");typeof this.events[e]!="object"&&(this.events[e]=[]),this.events[e].push(t);let r=this,s=function(){r.removeListener(e,t)};return this.events[e].length==1&&this.#r("#has-listeners",e),s}#s(e,t){if(typeof this.#t[e]!="object")return;this.#t[e].push(t);let r=this;return function(){r.#i(e,t)}}#i(e,t){var r;typeof this.#t[e]=="object"&&(r=this.#t[e].indexOf(t),r>-1&&this.#t[e].splice(r,1))}off(e,t){return this.removeListener(e,t)}removeListener(e,t){if(!this.#e){var r;this.events[e]&&(r=this.events[e].indexOf(t),r>-1&&(this.events[e].splice(r,1),this.events[e].length==0&&this.#r("#no-listeners",e)))}}emit(e){if(!this.#e&&typeof this.events[e]=="object"){var t,r,s,i=[].slice.call(arguments,1);for(r=this.events[e].slice(),s=r.length,t=0;t<s;t++)try{r[t].apply(this,i)}catch(n){this.#r("#listener-error",n,e,...i),this.logErrors&&console.error(`Error in listener for event "${e}":`,n)}}}#r(e,...t){if(!this.#e&&typeof this.#t[e]=="object"){var r,s,i;for(s=this.#t[e].slice(),i=s.length,r=0;r<i;r++)try{s[r].apply(this,t)}catch(n){this.#r("#listener-error",n,e,...t),this.logErrors&&console.error(`Error in listener for internal event "${e}":`,n)}}}once(e,t){return this.on(e,function r(){this.removeListener(e,r),t.apply(this,arguments)})}waitForEvent(e,t=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let s,i=this.on(e,()=>{t>0&&clearTimeout(s),i(),r(!0)});t>0&&(s=setTimeout(()=>{i(),r(!1)},t))})}waitForAnyEvent(e,t=0){if(this.#e)throw new Error("EventEmitter is destroyed");return new Promise(r=>{let s,i=[],n=()=>{t>0&&clearTimeout(s),i.forEach(o=>{o()}),r(!0)};e.forEach(o=>{i.push(this.on(o,n))}),t>0&&(s=setTimeout(()=>{n(),r(!1)},t))})}clear(){this.events={}}destroy(){this.#e||(this.#e=!0,this.#t={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]},this.events={})}clearEventListeners(e){(this.events[e]||[]).length>0&&(this.events[e]=[],this.#r("#no-listeners",e))}onHasEventListeners(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#s("#has-listeners",e)}onNoEventListeners(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#s("#no-listeners",e)}onListenerError(e){if(this.#e)throw new Error("EventEmitter is destroyed");return this.#s("#listener-error",e)}};export{h as EventEmitter};
