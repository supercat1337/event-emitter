var h=class{events={};on(e,s){typeof this.events[e]!="object"&&(this.events[e]=[]),this.events[e].push(s);let t=this,i=function(){t.removeListener(e,s)};return!/^(#has-listeners|#no-listeners)$/.test(e)&&this.events[e].length==1&&this.emit("#has-listeners",e),i}removeListener(e,s){var t;typeof this.events[e]=="object"&&(t=this.events[e].indexOf(s),t>-1&&(this.events[e].splice(t,1),!/^(#has-listeners|#no-listeners)$/.test(e)&&this.events[e].length==0&&this.emit("#no-listeners",e)))}emit(e){if(typeof this.events[e]=="object"){var s,t,i,r=[].slice.call(arguments,1);for(t=this.events[e].slice(),i=t.length,s=0;s<i;s++)try{t[s].apply(this,r)}catch(n){console.error(e,r),console.error(n)}}}once(e,s){return this.on(e,function t(){this.removeListener(e,t),s.apply(this,arguments)})}waitForEvent(e,s=0){return new Promise(t=>{let i,r=this.on(e,()=>{s>0&&clearTimeout(i),r(),t(!0)});s>0&&(i=setTimeout(()=>{r(),t(!1)},s))})}waitForAnyEvent(e,s=0){return new Promise(t=>{let i,r=[],n=()=>{s>0&&clearTimeout(i),r.forEach(o=>{o()}),t(!0)};e.forEach(o=>{r.push(this.on(o,n))}),s>0&&(i=setTimeout(()=>{n(),t(!1)},s))})}clear(){this.events={}}destroy(){this.clear()}clearEventListeners(e){(this.events[e]||[]).length>0&&(this.events[e]=[],this.emit("#no-listeners",e))}onHasEventListeners(e){return this.on("#has-listeners",e)}onNoEventListeners(e){return this.on("#no-listeners",e)}};export{h as EventEmitter};
