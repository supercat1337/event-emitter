var h=class{events={};#e={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]};#r=!1;logErrors=!0;get isDestroyed(){return this.#r}on(r,e){if(this.#r)throw new Error("EventEmitter is destroyed");typeof this.events[r]!="object"&&(this.events[r]=[]),this.events[r].push(e);let t=this,i=function(){t.removeListener(r,e)};return this.events[r].length==1&&this.#t("#has-listeners",r),i}#s(r,e){this.#e[r].push(e);let t=this;return function(){t.#i(r,e)}}#i(r,e){var t;typeof this.#e[r]=="object"&&(t=this.#e[r].indexOf(e),t>-1&&this.#e[r].splice(t,1))}off(r,e){return this.removeListener(r,e)}removeListener(r,e){if(!this.#r){var t;this.events[r]&&(t=this.events[r].indexOf(e),t>-1&&(this.events[r].splice(t,1),this.events[r].length==0&&this.#t("#no-listeners",r)))}}emit(r,...e){if(!this.#r&&typeof this.events[r]=="object")for(var t=this.events[r],i=t.length,s=0;s<i;s++)try{t[s].apply(this,e)}catch(o){this.#t("#listener-error",o,r,...e),this.logErrors&&console.error(`Error in listener for event "${r}":`,o)}}#t(r,...e){for(var t=this.#e[r],i=t.length,s=0;s<i;s++)try{t[s].apply(this,e)}catch(o){let n=o;if(n.cause={event:r,args:e},r==="#listener-error"){this.logErrors&&console.error(`Error in listener for internal event "${r}":`,n);continue}r==="#has-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${r}":`,n),this.#t("#listener-error",n,"#has-listeners",...e)),r==="#no-listeners"&&(this.logErrors&&console.error(`Error in listener for internal event "${r}":`,n),this.#t("#listener-error",n,"#no-listeners",...e))}}once(r,e){return this.on(r,function t(){this.removeListener(r,t),e.apply(this,arguments)})}waitForEvent(r,e=0){if(this.#r)throw new Error("EventEmitter is destroyed");return new Promise(t=>{let i,s=this.on(r,()=>{e>0&&clearTimeout(i),s(),t(!0)});e>0&&(i=setTimeout(()=>{s(),t(!1)},e))})}waitForAnyEvent(r,e=0){if(this.#r)throw new Error("EventEmitter is destroyed");return new Promise(t=>{let i,s=[],o=()=>{e>0&&clearTimeout(i),s.forEach(n=>{n()}),t(!0)};r.forEach(n=>{s.push(this.on(n,o))}),e>0&&(i=setTimeout(()=>{o(),t(!1)},e))})}clear(){this.events={}}destroy(){this.#r||(this.#r=!0,this.#e={"#has-listeners":[],"#no-listeners":[],"#listener-error":[]},this.events={})}clearEventListeners(r){if(this.#r)return;(this.events[r]||[]).length>0&&(this.events[r]=[],this.#t("#no-listeners",r))}onHasEventListeners(r){if(this.#r)throw new Error("EventEmitter is destroyed");return this.#s("#has-listeners",r)}onNoEventListeners(r){if(this.#r)throw new Error("EventEmitter is destroyed");return this.#s("#no-listeners",r)}onListenerError(r){if(this.#r)throw new Error("EventEmitter is destroyed");return this.#s("#listener-error",r)}};export{h as EventEmitter};
